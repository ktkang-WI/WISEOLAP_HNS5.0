<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wise.MarketingPlatForm.config.dao.ConfigDAO">
    
    <resultMap id="ConfigGeneralDTO" type="com.wise.MarketingPlatForm.config.dto.GeneralDTO">
      <result column="MAIN_TITLE" property="mainTitle" javaType="String"/>
      <result column="LICENSES_KEY" property="licensesKey" javaType="String"/>
      <result column="WEB_URL" property="webUrl" javaType="String"/>
      <result column="LOGIN_IMAGE" property="loginImage" javaType="String"/>
      <result column="LOGO" property="logo" javaType="String"/>
      <result column="SPREAD_JS_LICENSE" property="spreadJsLicense" javaType="String"/>
      <result column="SPREAD_JS_DESIGNER_LICENSE" property="spreadJsDesignLicense" javaType="String"/>
      <result column="KAKAO_MAP_API_KEY" property="kakaoMapApiKey" javaType="String"/>
    </resultMap>

		<select id="selectGeneralData" resultMap="ConfigGeneralDTO">
			SELECT
        CONFIG_MSTR.MAIN_TITLE,
        CONFIG_MSTR.LICENSES_KEY,
        CONFIG_MSTR.WEB_URL,
        WB_CONFIG_MSTR.LOGIN_IMAGE,
        WB_CONFIG_MSTR.LOGO,
        WB_CONFIG_MSTR.SPREAD_JS_LICENSE,
        WB_CONFIG_MSTR.SPREAD_JS_DESIGNER_LICENSE,
        WB_CONFIG_MSTR.KAKAO_MAP_API_KEY
        FROM CONFIG_MSTR INNER JOIN WB_CONFIG_MSTR ON 1 = 1
		</select>

    <update id="updateConfig" parameterType="com.wise.MarketingPlatForm.config.entity.ConfigMstrEntity">
      UPDATE CONFIG_MSTR
          SET 
              <if test='mainTitle != ""'>
                MAIN_TITLE = #{mainTitle, jdbcType=VARCHAR},
              </if>
              <if test='licensesKey != ""'>
                LICENSES_KEY = #{licensesKey, jdbcType=VARCHAR},
              </if>
              <if test='webUrl != ""'>
                WEB_URL = #{webUrl, jdbcType=VARCHAR},
              </if>
              MAIN_TAB_EX = MAIN_TAB_EX
          WHERE 1 = 1
    </update>

    <update id="updateWbConfig" parameterType="com.wise.MarketingPlatForm.config.entity.WbConfigMstrEntity">
        UPDATE WB_CONFIG_MSTR
          SET 
              <if test='loginImage != ""'>
                LOGIN_IMAGE = #{loginImage, jdbcType=VARCHAR},
              </if>
              <if test='logo != ""'>
                LOGO = #{logo, jdbcType=VARCHAR},
              </if>
              <if test='spreadJsLicense != ""'>
                SPREAD_JS_LICENSE = #{spreadJsLicense, jdbcType=VARCHAR},
              </if>
              <if test='spreadJsDesignLicense != ""'>
                SPREAD_JS_DESIGNER_LICENSE = #{spreadJsDesignLicense, jdbcType=VARCHAR},
              </if>
              <if test='kakaoMapApiKey != ""'>
                KAKAO_MAP_API_KEY = #{kakaoMapApiKey, jdbcType=VARCHAR},
              </if>
              REPORT_DIRECT_VIEW = REPORT_DIRECT_VIEW
          WHERE 1 = 1
    </update>

</mapper>